<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CAP-402 Whitepaper</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --arcium-purple: #6C44FC;
      --bg-dark: #0a0a0c;
      --bg-card: rgba(255,255,255,0.03);
      --border-subtle: rgba(255,255,255,0.08);
      --text-primary: #fafafa;
      --text-secondary: #888;
      --green: #22c55e;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: var(--bg-dark); color: var(--text-primary); min-height: 100vh; line-height: 1.6; }
    .topbar { background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%); padding: 1rem 2rem; border-bottom: 1px solid var(--border-subtle); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
    .topbar-left { display: flex; align-items: center; gap: 0.75rem; }
    .topbar-left img { height: 28px; }
    .topbar-left h1 { font-size: 1rem; color: var(--text-primary); }
    .nav-links { display: flex; gap: 0.5rem; }
    .nav-links a { padding: 0.4rem 0.8rem; background: var(--bg-card); border: 1px solid var(--border-subtle); border-radius: 6px; font-size: 0.8rem; color: var(--text-secondary); text-decoration: none; transition: all 0.2s; }
    .nav-links a:hover { background: rgba(108, 68, 252, 0.15); border-color: var(--arcium-purple); color: var(--text-primary); }
    .container { max-width: 800px; margin: 0 auto; padding: 2rem; }
    h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    h2 { font-size: 1.25rem; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-subtle); color: var(--text-primary); }
    h3 { font-size: 1rem; margin: 1.5rem 0 0.75rem; color: var(--arcium-purple); }
    p { color: var(--text-secondary); margin-bottom: 1rem; }
    .code-block { background: #111; border: 1px solid var(--border-subtle); border-radius: 6px; padding: 1rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--green); overflow-x: auto; margin: 1rem 0; white-space: pre; }
    table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
    th, td { border: 1px solid var(--border-subtle); padding: 0.5rem 1rem; text-align: left; }
    th { background: var(--bg-card); color: var(--text-primary); }
    td { color: var(--text-secondary); }
    ul, ol { margin: 1rem 0; padding-left: 1.5rem; color: var(--text-secondary); }
    li { margin-bottom: 0.5rem; }
    strong { color: var(--text-primary); }
    code { background: rgba(108, 68, 252, 0.2); color: var(--arcium-purple); padding: 2px 6px; border-radius: 4px; font-family: 'JetBrains Mono', monospace; }
    blockquote { border-left: 3px solid var(--arcium-purple); padding-left: 1rem; margin: 1rem 0; color: var(--text-secondary); font-style: italic; }
    a { color: var(--arcium-purple); }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="topbar-left">
      <a href="/"><img src="/public/CAP402logo.png" alt="CAP-402"></a>
      <h1>Whitepaper</h1>
    </div>
    <div class="nav-links">
      <a href="/docs">Docs</a>
      <a href="/docs/api-docs.html">API</a>
      <a href="/docs/sdk-docs.html">SDK</a>
      <a href="/">Home</a>
      <a href="https://github.com/TheQuantumChronicle/CAP402" target="_blank">GitHub</a>
    </div>
  </div>
  
  <div class="container">
    <h1>CAP-402: Agent Infrastructure Standard</h1>
    <p><strong>A Protocol for Semantic Capability Routing Between Autonomous Agents</strong></p>
    <p>Version 1.0 | January 2026 | <a href="https://cap402.com">cap402.com</a></p>
    
    <h2>Abstract</h2>
    <p>As autonomous AI agents proliferate across industries, a critical infrastructure gap has emerged: there is no standard protocol for agents to discover, negotiate, and execute capabilities from other agents or services. CAP-402 addresses this gap by introducing a semantic capability routing protocol that provides privacy-aware, economically-signaled execution with verifiable receipts.</p>
    <p>CAP-402 uniquely combines three complementary cryptographic technologies—<strong>Noir</strong> for zero-knowledge proofs, <strong>Arcium</strong> for confidential computation, and <strong>Inco</strong> for encrypted on-chain state—to deliver a complete privacy stack that enables fully private, verifiable, agent-driven authorization and execution.</p>
    
    <!-- Architecture Diagram -->
    <h2>System Architecture</h2>
    <pre class="code-block">
                              CAP-402 ARCHITECTURE
    ═══════════════════════════════════════════════════════════════════

    ┌─────────────┐     ┌─────────────────────────────────┐     ┌─────────────┐
    │   Agent A   │────▶│         CAP-402 Router          │────▶│  Service X  │
    └─────────────┘     │  ┌─────────────────────────┐   │     └─────────────┘
                        │  │   Privacy Stack          │   │     ┌─────────────┐
    ┌─────────────┐     │  │  ┌─────┐ ┌──────┐ ┌────┐│   │────▶│  Service Y  │
    │   Agent B   │────▶│  │  │Noir │ │Arcium│ │Inco││   │     └─────────────┘
    └─────────────┘     │  │  └─────┘ └──────┘ └────┘│   │     ┌─────────────┐
                        │  └─────────────────────────┘   │────▶│  Service Z  │
                        └─────────────────────────────────┘     └─────────────┘

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                           LAYER MODEL                                    │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Application    │  Agents, SDKs, Integrations                           │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Protocol       │  Capability Schema, Routing, Composition, Receipts    │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Execution      │  Public Executor, Confidential Executor               │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Privacy        │  Noir ZK Proofs, Arcium MPC, Inco FHE                 │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Security       │  Tokens, Trust Network, Handshake, Encryption         │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Economic       │  X.402 Hints, Privacy Cash, Trust-Based Pricing       │
    ├─────────────────────────────────────────────────────────────────────────┤
    │  Settlement     │  Solana (Future: Multi-chain)                         │
    └─────────────────────────────────────────────────────────────────────────┘
    </pre>
    
    <h2>1. Introduction</h2>
    <h3>1.1 The Agent Infrastructure Gap</h3>
    <p>Current agent frameworks (AutoGPT, LangChain, CrewAI) focus on orchestration but lack standardized infrastructure for:</p>
    <ul>
      <li><strong>Capability Discovery</strong> — How does an agent find services that can fulfill its needs?</li>
      <li><strong>Privacy Preservation</strong> — How can agents transact without exposing sensitive data?</li>
      <li><strong>Economic Coordination</strong> — How do agents negotiate costs and verify execution?</li>
      <li><strong>Trust Verification</strong> — How can agents verify the authenticity of other agents?</li>
    </ul>
    
    <h3>1.2 CAP-402 Solution</h3>
    <p>CAP-402 introduces a capability-centric protocol where:</p>
    <ol>
      <li>Agents describe <strong>what</strong> they need, not <strong>how</strong> to get it</li>
      <li>Routers match requests to optimal providers</li>
      <li>Privacy is configurable per-request (0-3 levels)</li>
      <li>Execution produces cryptographic receipts</li>
      <li>Economic hints enable cost optimization</li>
    </ol>
    
    <h2>2. Core Concepts</h2>
    <h3>2.1 Capabilities</h3>
    <p>A capability is a semantic unit of functionality with a unique identifier:</p>
    <pre class="code-block">{
  "capability_id": "cap.price.lookup.v1",
  "name": "Token Price Lookup",
  "description": "Get current price for any token",
  "inputs": { "base_token": "string", "quote_token": "string" },
  "outputs": { "price": "number", "source": "string" },
  "cost_hint": { "min": 0, "max": 0.001, "currency": "USD" }
}</pre>
    
    <h3>2.2 Privacy Levels</h3>
    <table>
      <tr><th>Level</th><th>Name</th><th>Description</th></tr>
      <tr><td>0</td><td>Public</td><td>No privacy, fastest execution</td></tr>
      <tr><td>1</td><td>Confidential</td><td>Encrypted in transit</td></tr>
      <tr><td>2</td><td>Private</td><td>Zero-knowledge proofs</td></tr>
      <tr><td>3</td><td>Maximum</td><td>Full MPC/FHE computation</td></tr>
    </table>
    
    <h2>3. Privacy Stack</h2>
    
    <!-- Privacy Stack Flow Diagram -->
    <pre class="code-block">
                         UNIFIED PRIVACY STACK FLOW
    ═══════════════════════════════════════════════════════════════════

    User / Agent
         │
         │ 1️⃣ Proves something privately (identity, limits, ownership)
         ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                    NOIR (Proof Layer)                            │
    │                                                                 │
    │  User generates ZK proof that:                                  │
    │    • They own NFT credential X                                  │
    │    • Their balance exceeds threshold                            │
    │    • Their identity satisfies KYC requirements                  │
    │                                                                 │
    │  OUTPUT: Compact proof (no secrets revealed)                    │
    └──────────────────────────────┬──────────────────────────────────┘
                                   │
                                   │ 2️⃣ Proof + encrypted context
                                   ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                   ARCIUM (Decision Layer)                        │
    │                                                                 │
    │  Arcium receives:                                               │
    │    • Verified Noir proof                                        │
    │    • Encrypted strategy parameters                              │
    │    • Encrypted risk thresholds                                  │
    │                                                                 │
    │  Arcium computes (on encrypted data):                           │
    │    • Is risk_exposure < daily_limit?                            │
    │    • Do all compliance rules pass?                              │
    │                                                                 │
    │  OUTPUT: ALLOW or DENY (signed attestation)                     │
    │  LEAKED: Nothing about thresholds or strategy                   │
    └──────────────────────────────┬──────────────────────────────────┘
                                   │
                                   │ 3️⃣ Decision + state update
                                   ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                    INCO (Execution Layer)                        │
    │                                                                 │
    │  If ALLOW:                                                      │
    │    • Execute swap with hidden amount                            │
    │    • Update encrypted daily exposure counter                    │
    │    • Update encrypted position balances                         │
    │    • Log encrypted audit trail                                  │
    │                                                                 │
    │  PUBLIC VISIBILITY: "A transaction occurred"                    │
    │  HIDDEN: Amount, strategy, positions, everything else           │
    └─────────────────────────────────────────────────────────────────┘
    </pre>
    
    <h3>3.1 Noir (Zero-Knowledge Proofs)</h3>
    <p>Noir enables agents to prove statements without revealing underlying data:</p>
    <ul>
      <li>Balance proofs ("I have > $10K" without revealing exact amount)</li>
      <li>Identity verification without exposing credentials</li>
      <li>Trade execution proofs for audit trails</li>
    </ul>
    
    <h3>3.2 Arcium (Confidential Computation)</h3>
    <p>Arcium provides MPC-based confidential computation:</p>
    <ul>
      <li>Confidential token swaps (cSPL tokens)</li>
      <li>Private order matching</li>
      <li>Encrypted portfolio management</li>
    </ul>
    
    <h3>3.3 Inco (Encrypted On-Chain State)</h3>
    <p>Inco enables FHE-based encrypted state on-chain:</p>
    <ul>
      <li>Encrypted agent messaging</li>
      <li>Private governance voting</li>
      <li>Confidential smart contract execution</li>
    </ul>
    
    <h3>3.4 Why All Three Are Required</h3>
    <table>
      <tr><th>Technology</th><th>What Happens If Removed</th></tr>
      <tr><td><strong>Noir</strong></td><td>Cannot generate portable proofs; users must expose data to prove conditions</td></tr>
      <tr><td><strong>Arcium</strong></td><td>Decision logic becomes public; strategies can be copied or gamed</td></tr>
      <tr><td><strong>Inco</strong></td><td>On-chain state leaks; execution results expose private information</td></tr>
    </table>
    <blockquote><strong>The One-Sentence Mental Model:</strong><br>Noir proves things privately, Arcium decides things privately, Inco stores and executes things privately.</blockquote>
    
    <h2>4. Agent-to-Agent Protocol</h2>
    <p>CAP-402 enables direct agent-to-agent communication:</p>
    
    <!-- A2A Protocol Diagram -->
    <pre class="code-block">
                           A2A PROTOCOL ARCHITECTURE
    ═══════════════════════════════════════════════════════════════════

       ┌─────────────┐    DIRECT INVOKE    ┌─────────────┐
       │   Agent A   │ ──────────────────▶ │   Agent B   │
       └─────────────┘                     └─────────────┘
             │                                    │
             │              AUCTION               │
             │    ┌───────────────────────┐      │
             └───▶│   AUCTION MANAGER     │◀─────┘
                  │                       │
                  │  • Bid collection     │
                  │  • Winner selection   │
                  │  • Escrow handling    │
                  └───────────────────────┘
                             │
                             ▼
                  ┌───────────────────────┐
                  │    SWARM COORDINATOR  │
                  │                       │
                  │  • Task distribution  │
                  │  • Result aggregation │
                  │  • Consensus voting   │
                  └───────────────────────┘
                             │
             ┌───────────────┼───────────────┐
             ▼               ▼               ▼
       ┌──────────┐   ┌──────────┐   ┌──────────┐
       │ Agent 1  │   │ Agent 2  │   │ Agent N  │
       └──────────┘   └──────────┘   └──────────┘
    </pre>
    
    <h3>4.1 Communication Modes</h3>
    <ul>
      <li><strong>Discovery</strong> — Find agents by capability</li>
      <li><strong>Invocation</strong> — Request execution from another agent</li>
      <li><strong>Auction</strong> — Competitive bidding for best execution</li>
      <li><strong>Swarm</strong> — Coordinate multi-agent workflows</li>
    </ul>
    
    <h3>4.2 A2A Message Types</h3>
    <table>
      <tr><th>Message Type</th><th>Purpose</th><th>Privacy</th></tr>
      <tr><td><code>a2a.invoke</code></td><td>Direct capability invocation</td><td>Configurable</td></tr>
      <tr><td><code>a2a.quote_request</code></td><td>Request trading quote</td><td>Encrypted</td></tr>
      <tr><td><code>a2a.quote_response</code></td><td>Respond with quote</td><td>Encrypted</td></tr>
      <tr><td><code>a2a.trade_execute</code></td><td>Execute agreed trade</td><td>Maximum</td></tr>
      <tr><td><code>a2a.auction_bid</code></td><td>Submit auction bid</td><td>Sealed</td></tr>
      <tr><td><code>a2a.swarm_task</code></td><td>Distribute swarm task</td><td>Configurable</td></tr>
    </table>
    
    <h2>5. MEV Protection</h2>
    <p>CAP-402 provides comprehensive MEV protection for trading operations:</p>
    
    <pre class="code-block">
                         MEV PROTECTION FLOW
    ═══════════════════════════════════════════════════════════════════

    TRADE SUBMISSION: swap(SOL → USDC, amount: 10,000)
                                   │
                                   ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │                    MEV RISK ANALYSIS                             │
    │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
    │  │ Sandwich Risk   │  │ Front-run Risk  │  │ Back-run Risk   │ │
    │  │ Probability: 75%│  │ Probability: 60%│  │ Probability: 40%│ │
    │  │ Est. Loss: $150 │  │ Est. Loss: $80  │  │ Est. Loss: $30  │ │
    │  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
    │                                                                 │
    │  Overall Risk: HIGH | Potential Loss: $260 | Savings: $234     │
    └──────────────────────────────┬──────────────────────────────────┘
                                   │
                    ┌──────────────┴──────────────┐
                    ▼                             ▼
    ┌───────────────────────────┐   ┌───────────────────────────────┐
    │   STANDARD EXECUTION      │   │   PROTECTED EXECUTION         │
    │   • Public mempool        │   │   • Private mempool (Jito)    │
    │   • Visible to MEV bots   │   │   • Confidential amounts      │
    │   • ~$260 expected loss   │   │   • Arcium C-SPL wrapping     │
    └───────────────────────────┘   └───────────────────────────────┘
    </pre>
    
    <h3>5.1 Protection Levels</h3>
    <table>
      <tr><th>Level</th><th>Method</th><th>Protection</th><th>Cost</th></tr>
      <tr><td>None</td><td>Public mempool</td><td>0%</td><td>Free</td></tr>
      <tr><td>Basic</td><td>Private RPC</td><td>40%</td><td>+0.1%</td></tr>
      <tr><td>Standard</td><td>Jito bundles</td><td>70%</td><td>+0.2%</td></tr>
      <tr><td>Maximum</td><td>Arcium C-SPL</td><td>95%</td><td>+0.5%</td></tr>
    </table>
    
    <h2>6. Security Framework</h2>
    <ul>
      <li><strong>API Key Authentication</strong> — Rate limiting and access control</li>
      <li><strong>Capability Tokens</strong> — Scoped, time-limited authorization</li>
      <li><strong>Trust Network</strong> — Agent reputation and verification</li>
      <li><strong>Cryptographic Receipts</strong> — Verifiable execution proofs</li>
    </ul>
    
    <h2>7. Implementation</h2>
    <table>
      <tr><th>Metric</th><th>Value</th></tr>
      <tr><td>TypeScript files</td><td>60+</td></tr>
      <tr><td>Tests</td><td>387 passing (19 test suites)</td></tr>
      <tr><td>API endpoints</td><td>100+</td></tr>
      <tr><td>Capabilities</td><td>13</td></tr>
      <tr><td>Sponsor integrations</td><td>4 (Arcium, Noir, Helius, Inco)</td></tr>
    </table>
    
    <h3>7.1 SDK One-Liners</h3>
    <pre class="code-block">import { prepareSwap, bestSwap, findAlpha } from '@cap402/sdk';

// Prepare swap - no setup required
const tx = await prepareSwap('SOL', 'USDC', 10);
console.log(tx.summary.headline);  // "Swap 10 SOL → ~1,433 USDC"

// Best execution - auto-picks DEX vs A2A
const result = await bestSwap('SOL', 'USDC', 100);
console.log(result.route, result.savings_vs_dex);

// Detect alpha signals
const signals = await findAlpha(['SOL', 'ETH', 'BTC']);
signals.forEach(s => console.log(s.token, s.direction));</pre>
    
    <h2>8. Roadmap</h2>
    <h3>Phase 1: Foundation ✅ Complete</h3>
    <ul>
      <li>Protocol specification (OpenAPI 3.1, JSON Schema, TypeScript types)</li>
      <li>Reference router (58 TypeScript files, 100+ endpoints)</li>
      <li>Privacy stack integration (Noir, Arcium, Inco fully integrated)</li>
      <li>Security framework (Multi-layer auth, capability tokens, trust network)</li>
    </ul>
    
    <h3>Phase 2: Expansion (Q1 2026)</h3>
    <ul>
      <li>Multi-language SDKs (Python, Rust, Go)</li>
      <li>Capability expansion (50+ capabilities)</li>
      <li>Mainnet deployment (Solana mainnet)</li>
    </ul>
    
    <h3>Phase 3: Decentralization (Q2 2026)</h3>
    <ul>
      <li>Distributed routers (10+ nodes)</li>
      <li>On-chain registry (Solana program)</li>
      <li>Staking & governance (CAP token)</li>
      <li>Cross-chain support (EVM, Cosmos)</li>
    </ul>
    
    <h2>9. Conclusion</h2>
    <p>CAP-402 represents a fundamental shift in how autonomous agents interact. By introducing semantic capabilities, privacy gradients, and economic coordination, we enable a new paradigm where agents can:</p>
    <ul>
      <li><strong>Discover</strong> capabilities by intent, not implementation</li>
      <li><strong>Execute</strong> with configurable privacy guarantees</li>
      <li><strong>Verify</strong> results through cryptographic receipts</li>
      <li><strong>Compose</strong> complex workflows atomically</li>
      <li><strong>Transact</strong> through standardized economic hints</li>
    </ul>
    
    <!-- Final Architecture Summary -->
    <pre class="code-block">
                         CAP-402 COMPLETE FLOW
    ═══════════════════════════════════════════════════════════════════

    ┌──────────┐                                           ┌──────────┐
    │  AGENT   │                                           │ PROVIDER │
    └────┬─────┘                                           └────┬─────┘
         │                                                      │
         │  1. invoke(capability_id, inputs, preferences)       │
         │ ────────────────────────────────────────────────────▶│
         │                                                      │
         │                    ┌─────────────────┐               │
         │                    │  CAP-402 ROUTER │               │
         │                    │                 │               │
         │                    │ • Validate      │               │
         │                    │ • Route         │               │
         │                    │ • Execute       │               │
         │                    │ • Receipt       │               │
         │                    └─────────────────┘               │
         │                                                      │
         │  2. {success, outputs, receipt, economic_hints}      │
         │ ◀────────────────────────────────────────────────────│
         │                                                      │
    ═════╧══════════════════════════════════════════════════════╧═════
    </pre>
    
    <blockquote>CAP-402 is not just a protocol—it's the infrastructure layer for the agent economy.<br><br><strong>"Agents don't call APIs. Agents call capabilities."</strong></blockquote>
    
    <p style="text-align: center; margin-top: 2rem; color: var(--text-muted);">
      <a href="https://github.com/TheQuantumChronicle/CAP402">GitHub</a> · 
      <a href="https://cap402.com">Website</a> · 
      <a href="mailto:cap402@proton.me">Contact</a>
    </p>
  </div>
</body>
</html>
